{% extends 'base.html' %}
{% block content %}

<div class="row">
    <div class="col-md-10 col-md-offset-1">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">{{ title }}</h3>
            </div>
            <div class="panel-body">

                <form class="form-horizontal" method="POST" action="">{% csrf_token %}
                    <div class="form-group">
                        <label class="control-label col-sm-2" for="nombre">Nombre:</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" id="nombre" name="nombre" value="{{ instance.nombre }}">
                        </div>
			    	    <label class="control-label col-sm-2" for="partido">Partido:</label>
                        <div class="col-sm-4">
			    	        <input type="text" class="form-control" id="partido" name="partido" value="{{ instance.partido }}">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="control-label col-sm-2" for="propietario">Propietario:</label>
                        <div class="col-sm-4">
			    	        <input type="text" class="form-control" id="propietario" name="propietario" value="{{ instance.propietario }}">
                        </div>
                        <label class="control-label col-sm-2" for="veterinario">Veterinario:</label>
                        <div class="col-sm-4">
                            <select class="form-control" name="veterinario" id="veterinario"></select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="control-label col-sm-2" for="RENSPA">RENSPA:</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" id="RENSPA" name="RENSPA" value="{{ instance.RENSPA }}">
                        </div>
                        <label class="control-label col-sm-2" for="CUIT">CUIT:</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control" id="CUIT" name="CUIT" value="{{ instance.CUIT }}">
                        </div>
                    </div>    

                    <div class="form-group">
                        <label class="control-label col-sm-2" for="categorias">Categorias:</label>
                        <div class="col-sm-4">
                            <label class="checkbox-inline  form-check-label" for="categorias">
                                <div form-check id="categorias"></div>
                            </label>
                        </div>
                    

<!--                <div class="form-group">
                        <div class="col-sm-2">
                            <div class="checkbox">
                                <label class="checkbox-inline form-check-label" for="categorias">Categorias:</label>
			    	            <div form-check id="categorias"></div>
                            </div>
                        </div>
                    </div>
 -->        
                    
                        <label class="control-label col-sm-2" for="explotacion">Explotaci√≥n:</label>
                        <div class="col-sm-4">
                            <label class="checkbox-inline form-check-label" for="explotacion">
                                <div form-check id="explotacion"></div>
                            </label>
                        </div>
                    </div>

                    <!--  
        <div class="row">
            <div class="col-md-4">
            	<div class="form-group">
			    	<label class="form-check-label" for="explotacion">Explotacion:</label>
			    	<div  form-check id="explotacion"></div>
                </div>
            </div>
        </div> -->

					<div class="form-group">
						<label class="control-label col-sm-2" for="activo">Estado:</label>
						<div class="col-sm-10">
							<div class="checkbox form-check disabled">
								<label class="form-check-label" for="activo">
									<input type="checkbox" class="form-check-input" id="activo" name="activo" value="{{ instance.activo }}" checked disabled> Activo
								</label>
							</div>
						</div>
					</div>

					<div class="form-group">
			    		<div class="col-sm-offset-2 col-sm-10">
							<button type="submit" class="btn btn-default">Enviar</button>
						</div>
					</div>
				</form>
    		</div>
        </div>
    </div>
</div>

{% endblock %}
{% block javascript %} 
<script type="text/javascript">


$(document).ready(function() {
        var selectveterinario = "{{instance.veterinario.id }}"

        var catelist = []
            "{% for x in instance.categorias.all %}"
        catelist.push("{{x.id}}")
            "{% endfor %}"

        var explolist = []    
            "{% for x in instance.explotacion.all %}"
        explolist.push("{{x.id}}")
            "{% endfor %}"
        $.ajax({
            url:"/j_veterinario/",
            type:"GET",
            dataType: "json",
            success: function(veterinario){
                $.each(veterinario,function(index, obj) 
                {   
                    console.log(veterinario)
                    if(obj.id == selectveterinario)
                    {
                    $('#veterinario').append('<option selected value=' + obj.id + '>' + obj.apellido +','+ obj.nombre + '</option>');
                    }
                    else{
                    $('#veterinario').append('<option value=' + obj.id + '>' + obj.apellido +','+ obj.nombre + '</option>');
                    }
                });
            }
        }); // finaliza el primer select 

        $.ajax({
            url:"/j_categoria/",
            type:"GET",
            dataType: "json",
            success: function(categoria){
                console.log("categoria: " + catelist)
                $.each(categoria,function(index, obj) 
                {   
                    $('#categorias').append('<input type="checkbox" name="categorias" value="'+ obj.id+'"> '+obj.descripcion+'<br>');
                });

                $("#categorias > input").each(function(){
                    for (var i = catelist.length - 1; i >= 0; i--) {
                    
                    if($(this).attr("value") == catelist[i])
                    {
                         this.setAttribute("checked", "checked")
                    } //if
                    } //for

                }); // Categorias Checked

            }
        }); // primer checkbox

        $.ajax({
            url:"/j_explotacion/",
            type:"GET",
            dataType: "json",
            success: function(explotacion){
                console.log("explotacion:" + explolist)
                $.each(explotacion,function(index, obj) 
                {      
                    $('#explotacion').append('<input type="checkbox" name="explotacion" value="'+ obj.id+'"> '+obj.descripcion+'<br>');
                });

                $("#explotacion > input").each(function(){
                    for (var i = explolist.length - 1; i >= 0; i--) {
                    
                        if($(this).attr("value") == explolist[i])
                        {
                             this.setAttribute("checked", "checked")
                        } //if
                    } //for
                }); // Explotacion Checked
            }
        }); // segundo checkbox


    });  
</script>
{% endblock %}